<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>GraphQL vs REST</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css">

	<style>
		.fragment.blur {
			filter: blur(1rem);
		}

		.fragment.blur.visible {
			filter: none;
		}
	</style>

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL vs REST API's</h2>
				<p>Daniel Danielecki</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>What is a GraphQL?</h2>
				<p>Query language for API's, <strong>alternative</strong> (not replacement) for REST.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Why GraphQL?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/underfetching.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<code class="language-json" data-trim data-line-numbers="|2,4,12-15"><pre>
{
  "id": "person_1",
  "uri": "/production/resources/persons/person_1",
  "name": "John",
  "resourceType": {
    "type": "ActorType",
    "id": "actortype_1",
    "uri": "/types/resources/actors/actortype_1",
    "name": "Worker"
  },
  "isAdditional": false,
  "email": "harlow@gmail.com",
  "firstName": "John",
  "lastName": "Harlow",
  "phoneNumber": "+420775987632",
  "maxOverTime": null
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Frontend?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Backend?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Architects?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Others?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Why GraphQL?</h2>
				<p>Query only what you need.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Why GraphQL?</h2>
				<ul>
					<li class="fragment custom blur highlight-current-white fade-up">No Under-Fetching</li>
					<li class="fragment custom blur highlight-current-white fade-up">No Over-Fetching</li>
					<li class="fragment custom blur highlight-current-white fade-up">Nullability/Non-null ("!")</li>
					<li class="fragment custom blur highlight-current-white fade-up">Performance*</li>
					<li class="fragment custom blur highlight-current-white fade-up">Single Endpoint</li>
					<li class="fragment custom blur highlight-current-white fade-up">Strong Typing</li>
					<li class="fragment custom blur highlight-current-white fade-up">Subscriptions</li>
					<li class="fragment custom blur highlight-current-white fade-up">Versioning</li>
					<li class="fragment custom blur highlight-current-white fade-up">...</li>
				</ul>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>REST API's?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>GraphQL?</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>GraphQL Basics</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Schema</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<code class="language-graphql" data-trim data-line-numbers="|1|2|3|4"><pre>
type Query { ... }
type Mutation {	... }
type Subscription { ... }
input CreateUserInput { ... }
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Object Types</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Object Types</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1,8|2,9|3,4,10,11|5|6,12"><pre>
type User {
	id: ID!
	name: String!
	email: String!
	age: Int
	posts: [Post!]!
}
type Post {
	id: ID!
	title: String!
	body: String!
	author: User!
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Query</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Query</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|6|1,6|2|3|4|5"><pre>
type Query {
	users(query: String): [User!]!
	posts(query: String): [Post!]!
	user: User!
	post: Post!
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Basics: Query</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|5|1,5|2|4|2,4|3"><pre>
query {
	users {
		id
	}
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/query-demo.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/query-demo2.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Query == "GET"</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Mutations</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Mutations</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|5|1,5|2|3|4|7-11|2"><pre>
type Mutation {
	createUser(data: CreateUserInput!): User!
	deleteUser(id: ID!): User!
	updateUser(id: ID!, data: UpdateUserInput!): User!
}

input CreateUserInput {
  name: String!
  email: String!
  age: Int
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Mutations</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|7|1,7|2|6|2,6|3|4|5"><pre>
mutation {
	createUser(data: { name: "Daniel", email: "foo@example.com", age: 25 }) {
		id
		email
		age
	}
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/mutation-demo.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h3>GraphQL Mutation<br>==<br>"POST", "PUT", "PATCH", "DELETE" (C<s>R</s>UD)</h3>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Subscriptions</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Subscriptions</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|3|1,3|2"><pre>
type Subscription {
	count: Int!
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Subscriptions</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1|3|1,3|2"><pre>
subscription {
	count
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/subscriptions1-demo.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/subscriptions2-demo.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL Subscription<br>==<br>WebSockets</h2>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Beyond the Basics</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Learning Curve</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Learning Curve</h2>
				<p>GraphQL takes <strong>more time</strong> to learn.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Global Object Identification</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Global Object Identification: GraphQL</h2>
				<code class="language-graphql" data-trim data-line-numbers="|2|3-5"><pre>
query {
	user(id: "1") {
		id
		name
		email
	}
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Global Object Identification: REST</h2>
				<code class="language-javascript" data-trim data-line-numbers="|1"><pre>
GET /resources/:id
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Pagination</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Pagination: GraphQL</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1,11|2,10|3-5|6-9"><pre>
query {
	items(limit: 10, offset: 20) {
		total
		limit
		offset
		items {
			id
			name
		}
	}
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Pagination: REST</h2>
				<code class="language-javascript" data-trim data-line-numbers="|1"><pre>
GET /api/items?limit=10&offset=20
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Sorting</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Sorting: GraphQL</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1,6|2,5|3-4"><pre>
query {
	items(sort: { field: "name", order: DESC }) {
		id
		name
	}
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Sorting: REST</h2>
				<code class="language-javascript" data-trim data-line-numbers="|1"><pre>
GET /api/items?sortBy=name&order=desc
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>StackOverflow</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>StackOverflow</h2>
				<p>What are Developers asking for?</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-stackoverflow.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-stackoverflow2.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-stackoverflow3.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Won't work</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1,3|2"><pre>
query {
	*
}
			</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Won't work</h2>
				<code class="language-graphql" data-trim data-line-numbers="|1,5|2,4|3"><pre>
query {
	users {
		*
	}
}
			</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Introspection</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection-demo.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection-demo-disable.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection-demo-disabled.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection-off-prod.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/owasp-introspection.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/introspection-security.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-voyager.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Circular Queries</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/circularqueries.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Standardization<br>vs<br>Fragmentation</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Standardization: REST</h2>
				<p>HTTP methods (GET, POST, PUT, DELETE), status codes (200, 404, 500).</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Fragmentation: GraphQL</h2>
				<p>Apollo Server, GraphQL Yoga, Envelop, Apollo Client, Relay, urql.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Projects</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/dataloader.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-voyager-outdated.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/graphql-newsletter.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/maintainers-apollo-graphql.png">
				<img data-src="assets/maintainers-theguild.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Advanced</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Caching</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Caching</h2>
				<p>GraphQL's caching <strong>is more complex</strong>.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Caching: REST (Express.js)</h2>
				<code class="language-javascript" data-trim data-line-numbers="|13-17|19-22"><pre>
const express = require('express');
const app = express();
const port = 3000;

app.get('/api/resource', (req, res) => {
	const resource = {
		id: 1,
		name: "Resource",
		value: "Some data",
		lastModified: new Date().toISOString()
	};

	// Set Cache-Control header
	res.setHeader('Cache-Control', 'public, max-age=3600');
	// Set ETag header
	const eTag = 'some-etag-value';
	res.setHeader('ETag', eTag);

	// Check if the client's ETag matches the server's ETag
	if (req.headers['if-none-match'] === eTag) {
		return res.status(304).send(); // Not Modified
	}

	res.json(resource);
});

app.listen(port, () => {
		console.log(`Server is running on http://localhost:${port}`);
});
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Caching: GraphQL (Apollo Server)</h2>
				<code class="language-javascript" data-trim data-line-numbers="|2|21-23|32|33-35|32"><pre>
const { ApolloServer, gql } = require('apollo-server');
const { ApolloServerPluginCacheControl } = require('apollo-server-core');

// Schema definition
const typeDefs = gql`
	type Query {
		resource(id: ID!): Resource
	}

	type Resource {
		id: ID!
		name: String
		value: String
	}
`;

// Resolvers
const resolvers = {
	Query: {
		resource: (parent, { id }, context, info) => {
			// Set cache control hints
			info.cacheControl.setCacheHint({ maxAge: 3600 });
			return { id, name: "Resource", value: "Some data" };
		}
	}
};

// Apollo Server setup
const server = new ApolloServer({
	typeDefs,
	resolvers,
	plugins: [ApolloServerPluginCacheControl({ defaultMaxAge: 5 })],
	cacheControl: {
		defaultMaxAge: 3600,
	}
});

server.listen().then(({ url }) => {
	console.log(`Server ready at ${url}`);
});

				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Caching: GraphQL (Apollo Client)</h2>
				<code class="language-javascript" data-trim data-line-numbers="|1|6"><pre>
import { ApolloClient, InMemoryCache, gql } from '@apollo/client';

// Initialize Apollo Client
const client = new ApolloClient({
	uri: 'https://example.com/graphql',
	cache: new InMemoryCache()
});

// Query
const GET_RESOURCE = gql`
	query GetResource($id: ID!) {
		resource(id: $id) {
			id
			name
			value
		}
	}
`;

// Fetch data
client.query({
	query: GET_RESOURCE,
	variables: { id: 1 }
}).then(result => {
	console.log(result.data);
	// Data is now cached in the client
});

// Subsequent queries will use the cached data
client.query({
	query: GET_RESOURCE,
	variables: { id: 1 }
}).then(result => {
	console.log('From Cache:', result.data);
});
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Error Handling</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Error Handling</h2>
				<p>Beyond 200 when an error occured.</p>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Error Handling</h2>
				<table>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<th>REST</th>
						<th>GraphQL</th>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Status codes to indicate nature of errors</td>
						<td>Error classes</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Error messages within response body</td>
						<td>Error messages within resolvers</td>
					</tr>
				</table>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Error Handling: REST</h2>
				<code class="language-javascript" data-trim data-line-numbers="|6|9"><pre>
try {
	const resource = await Resource.findByPk(id);
	if (resource) {
		res.json(resource);
	} else {
		res.status(404).json({ error: 'Resource not found' });
	}
} catch (error) {
	res.status(500).json({ error: error.message });
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Error Handling: GraphQL</h2>
				<code class="language-javascript" data-trim data-line-numbers="|6|9"><pre>
try {
	const resource = await Resource.findByPk(id);
	if (resource) {
		return resource;
	} else {
		throw new UserInputError('Resource not found');
	}
} catch (error) {
	throw new Error('Failed to fetch resource');
}
				</code></pre>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Errors<br>!==<br>200</h2>
				<ul>
					<li class="fragment custom blur highlight-current-white fade-up">Bad Request: 400</li>
					<li class="fragment custom blur highlight-current-white fade-up">Method Not Allowed: 405</li>
					<li class="fragment custom blur highlight-current-white fade-up">Internal Server Error: 500</li>
				</ul>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/demo-error200.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/demo-errormessage.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Unit Testing</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/unittesting.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Trends</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/interest-github.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/interest-google-trends.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/interest-stackoverflow.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/interest-satisfaction.png">
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>GraphQL vs REST</h2>
				<table>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<th>Feature</th>
						<th>REST</th>
						<th>GraphQL</th>
						<th>Similar/Different</th>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>HTTP</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>API endp.</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>JSON</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Request</td>
						<td>Rigid</td>
						<td>Flexible</td>
						<td>Different</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Call API</td>
						<td>Endpoint</td>
						<td>Query</td>
						<td>Different</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Response</td>
						<td>Server</td>
						<td>Client</td>
						<td>Different</td>
					</tr>
					<tr class="fragment custom blur highlight-current-white fade-up">
						<td>Size resp.</td>
						<td>Server</td>
						<td>Client</td>
						<td>Different</td>
					</tr>
				</table>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h1>Conclusion</h1>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Useful, but</h2>
				<ul>
					<li class="fragment custom blur highlight-current-white fade-up">Caching</li>
					<li class="fragment custom blur highlight-current-white fade-up">Circular Queries (FE)</li>
					<li class="fragment custom blur highlight-current-white fade-up">Error Handling</li>
					<li class="fragment custom blur highlight-current-white fade-up">Introspection</li>
					<li class="fragment custom blur highlight-current-white fade-up">query *</li>
					<li class="fragment custom blur highlight-current-white fade-up">Up-to-date projects</li>
					<li class="fragment custom blur highlight-current-white fade-up">Unit Testing</li>
				</ul>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<h2>Read more</h2>
				<ul>
					<li class="fragment custom blur highlight-current-white fade-up">SOAP</li>
					<li class="fragment custom blur highlight-current-white fade-up">g/tRPC</li>
					<li class="fragment custom blur highlight-current-white fade-up">MQTT</li>
					<li class="fragment custom blur highlight-current-white fade-up">Webhooks</li>
					<li class="fragment custom blur highlight-current-white fade-up">WebSockets</li>
				</ul>
			</section>
			<section data-transition="zoom" data-transition-speed="slow">
				<img data-src="assets/qr.png" height="550">
				<p><a href="https://danieldanielecki.com" target="_blank">danieldanielecki.com</a></p>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			slideNumber: 'c/t',

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
		});
	</script>
</body>

</html>
